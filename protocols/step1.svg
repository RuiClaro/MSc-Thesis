<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1"
 width="600px" height="309px"
 viewBox="0 0 600 309"
 xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"
 stroke-width="1" text-rendering="geometricPrecision">
<polygon fill="white" points="135,7 163,7 163,16 135,16"/>
<text x="150" y="16" textLength="26" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

Alice
</text>
<polygon fill="white" points="438,7 460,7 460,16 438,16"/>
<text x="450" y="16" textLength="21" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

Bob
</text>
<line x1="150" y1="22" x2="150" y2="50" stroke="black"/>
<line x1="450" y1="22" x2="450" y2="50" stroke="black"/>
<path d="M 47 36 A146,6 0 0,1 150,26" stroke="white" fill="none"/><line x1="43" y1="32" x2="51" y2="40" stroke="white"/>
<line x1="51" y1="32" x2="43" y2="40" stroke="white"/>
<line x1="150" y1="50" x2="150" y2="67" stroke="black"/>
<line x1="450" y1="50" x2="450" y2="67" stroke="black"/>
<polygon fill="white" points="198,51 400,51 400,60 198,60"/>
<text x="199" y="60" textLength="200" font-family="Helvetica" font-size="12" fill="black">
\hspace{-49mm} ($keyA.sk,keyA.pk$)
</text>
<line x1="150" y1="67" x2="150" y2="95" stroke="black"/>
<line x1="450" y1="67" x2="450" y2="95" stroke="black"/>
<line x1="150" y1="78" x2="450" y2="78" stroke="black"/>
<line x1="450" y1="78" x2="440" y2="84" stroke="black"/>
<polygon fill="white" points="180,68 419,68 419,77 180,77"/>
<text x="181" y="77" textLength="237" font-family="Helvetica" font-size="12" fill="black">
\hspace{ 24mm} \raisebox{1mm}{$keyA.pk$}
</text>
<line x1="150" y1="95" x2="150" y2="112" stroke="black"/>
<line x1="450" y1="95" x2="450" y2="112" stroke="black"/>
<polygon fill="white" points="173,96 426,96 426,105 173,105"/>
<text x="174" y="105" textLength="251" font-family="Helvetica" font-size="12" fill="black">
\hspace{-48mm} $x_{t}^{E}=EN(x_{t},keyA.pk)$
</text>
<line x1="150" y1="112" x2="150" y2="140" stroke="black"/>
<line x1="450" y1="112" x2="450" y2="140" stroke="black"/>
<line x1="150" y1="123" x2="450" y2="123" stroke="black"/>
<line x1="450" y1="123" x2="440" y2="129" stroke="black"/>
<polygon fill="white" points="178,113 420,113 420,122 178,122"/>
<text x="179" y="122" textLength="240" font-family="Helvetica" font-size="12" fill="black">
\hspace{ 29mm} \raisebox{1mm}{$x_{t}^{E}$}
</text>
<line x1="150" y1="140" x2="150" y2="157" stroke="black"/>
<line x1="450" y1="140" x2="450" y2="157" stroke="black"/>
<polygon fill="white" points="153,141 445,141 445,150 153,150"/>
<text x="154" y="150" textLength="290" font-family="Helvetica" font-size="12" fill="black">
\hspace{81mm}$z_{k,n}^E=\prod_t(x_t^E)^{y_{k,n+t}}$
</text>
<line x1="150" y1="157" x2="150" y2="174" stroke="black"/>
<line x1="450" y1="157" x2="450" y2="174" stroke="black"/>
<polygon fill="white" points="195,158 403,158 403,167 195,167"/>
<text x="196" y="167" textLength="206" font-family="Helvetica" font-size="12" fill="black">
\hspace{ 69mm} random $b_{k,n}^{E}$
</text>
<line x1="150" y1="174" x2="150" y2="191" stroke="black"/>
<line x1="450" y1="174" x2="450" y2="191" stroke="black"/>
<polygon fill="white" points="158,175 441,175 441,184 158,184"/>
<text x="159" y="184" textLength="281" font-family="Helvetica" font-size="12" fill="black">
\hspace{80mm}$a_{k,n}^E=z_{k,n}^E\tx(-b_{k,n}^E)$
</text>
<line x1="150" y1="191" x2="150" y2="219" stroke="black"/>
<line x1="450" y1="191" x2="450" y2="219" stroke="black"/>
<line x1="450" y1="202" x2="150" y2="202" stroke="black"/>
<line x1="150" y1="202" x2="160" y2="208" stroke="black"/>
<polygon fill="white" points="171,192 427,192 427,201 171,201"/>
<text x="172" y="201" textLength="254" font-family="Helvetica" font-size="12" fill="black">
\hspace{ 30mm} \raisebox{1mm}{$a_{k,n}^{E}$}
</text>
<line x1="150" y1="219" x2="150" y2="247" stroke="black"/>
<line x1="450" y1="219" x2="450" y2="247" stroke="black"/>
<polygon fill="white" points="158,220 441,220 441,229 158,229"/>
<text x="159" y="229" textLength="281" font-family="Helvetica" font-size="12" fill="black">
\hspace{-49mm} $a_{k,n}=DE(a_{k,n}^{E},keyA.sk)$ 
</text>
<polygon fill="white" points="161,231 437,231 437,240 161,240"/>
<text x="162" y="240" textLength="274" font-family="Helvetica" font-size="12" fill="black">
 \hspace{-41mm} $=\sum_{t} x_{t}y_{k,n+t}-b_{k,n}$
</text>
<line x1="150" y1="247" x2="150" y2="264" stroke="black"/>
<line x1="450" y1="247" x2="450" y2="264" stroke="black"/>
<polygon fill="white" points="160,248 438,248 438,257 160,257"/>
<text x="161" y="257" textLength="276" font-family="Helvetica" font-size="12" fill="black">
\hspace{ 78mm} ${\ol b_k}=[b_{k,1},\cdots,b_{k,N}]$
</text>
<line x1="150" y1="264" x2="150" y2="281" stroke="black"/>
<line x1="450" y1="264" x2="450" y2="281" stroke="black"/>
<polygon fill="white" points="160,265 439,265 439,274 160,274"/>
<text x="161" y="274" textLength="277" font-family="Helvetica" font-size="12" fill="black">
\hspace{-40mm} ${\ol a_k}=[a_{k,1},\cdots,a_{k,N}]$
</text>
<line x1="150" y1="281" x2="150" y2="309" stroke="black"/>
<line x1="450" y1="281" x2="450" y2="309" stroke="black"/>
<path d="M 450 285 A146,6 0 0,1 553,295" stroke="white" fill="none"/><line x1="549" y1="291" x2="557" y2="299" stroke="white"/>
<line x1="557" y1="291" x2="549" y2="299" stroke="white"/>
<line x1="150" y1="303" x2="150" y2="309" stroke="black"/>
<line x1="450" y1="303" x2="450" y2="309" stroke="black"/>
</svg>
